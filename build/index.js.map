{"version":3,"sources":["../src/index.js"],"names":["relativePathRe","jsFile","AmberJSX","transpile","sourcePath","destPath","originalSourcePath","test","process","cwd","replace","startsWith","Error","split","__dirname","readFile","err","code","console","log","transpiled","write","writeFile","toVTree","parser"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;;;AAEA,MAAMA,iBAAiB,SAAvB;AACA,MAAMC,SAAS,2BAAf;;AAEO,MAAMC,8BAAW;AACtB;;;;;AAKAC,YAAUC,UAAV,EAAsBC,QAAtB,EAAgC;AAC9B;AACA,QAAIC,qBAAqBF,UAAzB;AACA;AACA,QAAIJ,eAAeO,IAAf,CAAoBH,UAApB,CAAJ,EAAqC;AACnCA,mBAAaI,QAAQC,GAAR,KAAgB,GAAhB,GAAsBL,WAAWM,OAAX,CAAmBV,cAAnB,EAAmC,EAAnC,CAAnC;AACD,KAFD,MAEO,IAAI,CAACI,WAAWO,UAAX,CAAsB,GAAtB,CAAL,EAAiC;AACtCP,mBAAaI,QAAQC,GAAR,KAAgB,GAAhB,GAAsBL,UAAnC;AACD;;AAED,QAAI,CAACH,OAAOM,IAAP,CAAYH,UAAZ,CAAL,EAA8B;AAC5B,YAAM,IAAIQ,KAAJ,CAAW,wBAAuBR,UAAW,IAA7C,CAAN;AACD;;AAEDC,eAAWA,YAAaD,WAAWS,KAAX,CAAiB,aAAjB,EAAgC,CAAhC,IAAqC,cAA7D;;AAEA,QAAIb,eAAeO,IAAf,CAAoBF,QAApB,CAAJ,EAAmC;AACjCA,iBAAWS,YAAY,MAAZ,GAAqBT,SAASK,OAAT,CAAiBV,cAAjB,EAAiC,EAAjC,CAAhC;AACD,KAFD,MAEO,IAAI,CAACK,SAASM,UAAT,CAAoB,GAApB,CAAL,EAA+B;AACpCN,iBAAWS,YAAY,MAAZ,GAAqBT,QAAhC;AACD;;AAED,iBAAGU,QAAH,CAAYX,UAAZ,EAAwB,OAAxB,EAAiC,CAACY,GAAD,EAAMC,IAAN,KAAe;AAC9C,UAAID,GAAJ,EAAS;AACPE,gBAAQC,GAAR,CAAYH,GAAZ;AACA;AACD;AACD,YAAMI,aAAa,mBAAWH,IAAX,EAAiBI,KAAjB,EAAnB;AACA,mBAAGC,SAAH,CAAajB,QAAb,EAAuBe,UAAvB,EAAmC,MAAM;AACvCF,gBAAQC,GAAR,CAAa,6BAA4Bb,kBAAmB,KAA5D;AACAY,gBAAQC,GAAR,CAAY,yBAAZ;AACD,OAHD;AAID,KAVD;AAWD,GAvCqB;;AAyCtBI,UAAQN,IAAR,EAAc;AACZ,QAAI,OAAOA,IAAP,KAAgB,QAApB,EACE,MAAM,IAAIL,KAAJ,CAAU,sCAAV,CAAN;;AAEF,UAAMY,SAAS,oBAAf;AACA,WAAOA,OAAOD,OAAP,CAAeN,IAAf,CAAP;AACD;AA/CqB,CAAjB","file":"index.js","sourcesContent":["import { Writer } from './writer';\nimport { Parser } from './parser';\nimport fs from 'fs';\n\nconst relativePathRe = /^(\\.)\\//;\nconst jsFile = /([^\\/\\s*]*)\\.(jsx|js)\\s*$/;\n\nexport const AmberJSX = {\n  /**\n   * Transpile file\n   * @param {String} sourcePath source path\n   * @param {String} destPath optional destination path.\n   */\n  transpile(sourcePath, destPath) {\n    // Save original value.\n    var originalSourcePath = sourcePath;\n    // convert relative path to absolute path.\n    if (relativePathRe.test(sourcePath)) {\n      sourcePath = process.cwd() + '/' + sourcePath.replace(relativePathRe, '');\n    } else if (!sourcePath.startsWith('/')) {\n      sourcePath = process.cwd() + '/' + sourcePath;\n    }\n\n    if (!jsFile.test(sourcePath)) {\n      throw new Error(`Unrecognizable file: ${sourcePath}. `);\n    }\n\n    destPath = destPath || (sourcePath.split(/\\.(jsx|js)$/)[0] + '.compiled.js');\n\n    if (relativePathRe.test(destPath)) {\n      destPath = __dirname + '/../' + destPath.replace(relativePathRe, '');\n    } else if (!destPath.startsWith('/')) {\n      destPath = __dirname + '/../' + destPath;\n    }\n\n    fs.readFile(sourcePath, 'utf-8', (err, code) => {\n      if (err) {\n        console.log(err);\n        return;\n      }\n      const transpiled = new Writer(code).write();\n      fs.writeFile(destPath, transpiled, () => {\n        console.log(`\\n> AmberJSX: transpiling ${originalSourcePath}...`);\n        console.log('> AmberJSX: finished.\\n');\n      })\n    });\n  },\n\n  toVTree(code) {\n    if (typeof code !== 'string')\n      throw new Error('Param to `toVTree` must be a string!');\n\n    const parser = new Parser();\n    return parser.toVTree(code);\n  }\n};\n"]}